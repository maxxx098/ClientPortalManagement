import{j as e,u as $,a as U,r as l}from"./app-Ck5WeuDF.js";import{c as a,B as j}from"./createLucideIcon-B_bktm_V.js";import{C as m,a as h,b as u,c as p,d as V}from"./card-DEJaNszi.js";import{B as y}from"./badge-CsZpBTuh.js";import{A as q,a as J}from"./alert-CBe3Pi2Z.js";import{A as Q}from"./app-layout-DoQbwlH_.js";import{A as w,a as v,b as C,c as A,d as D,e as k,f as W,g as K}from"./alert-dialog-CFoMYek6.js";import{P as X}from"./plus-C_1lLlVA.js";import{K as Y}from"./app-sidebar-DDhbTrZc.js";import{C as T}from"./check-CaqIbujm.js";import{C as f}from"./circle-alert-CG4-rjs7.js";import{C as Z}from"./copy-DbFXNnUa.js";import{T as ee}from"./trash-2-Ccc7LcjO.js";/* empty css            */import"./app-sidebar-header-DZLkAQAh.js";import"./index-DbRe66M7.js";import"./index-CN8Djskw.js";import"./index-_ENhd-2p.js";import"./index-CMWG4mbA.js";import"./index-D329iiHL.js";import"./Logo-Cmirgiq5.js";function te({className:s,...r}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:a("w-full caption-bottom text-sm",s),...r})})}function se({className:s,...r}){return e.jsx("thead",{"data-slot":"table-header",className:a("[&_tr]:border-b",s),...r})}function re({className:s,...r}){return e.jsx("tbody",{"data-slot":"table-body",className:a("[&_tr:last-child]:border-0",s),...r})}function S({className:s,...r}){return e.jsx("tr",{"data-slot":"table-row",className:a("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...r})}function n({className:s,...r}){return e.jsx("th",{"data-slot":"table-head",className:a("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...r})}function o({className:s,...r}){return e.jsx("td",{"data-slot":"table-cell",className:a("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...r})}function le(s){return{"client-keys.store":"/admin/client-keys"}[s]||"/"}function De({keys:s}){const{post:r,delete:E,processing:I}=$(),{flash:c}=U().props,[O,g]=l.useState(null),[P,d]=l.useState(!1),[B,i]=l.useState(!1),[b,_]=l.useState(null),[N,x]=l.useState({title:"",description:""});l.useEffect(()=>{c?.error&&(x({title:c.error.title,description:c.error.description}),d(!1),i(!0))},[c?.error]);const H=()=>{r(le("client-keys.store"))};function L(){b!==null&&E(`/admin/client-keys/${b}`,{preserveScroll:!0,preserveState:!1,onSuccess:()=>d(!1),onError:t=>{t?.error?x(t.error):x({title:"Error",description:"An unexpected error occurred."}),i(!0)}})}const R=t=>{t.projects_count>0?(x({title:"Cannot Delete Client Key",description:`This client key has ${t.projects_count} project(s) linked to it. Please reassign or delete them first.`}),i(!0)):(_(t.id),d(!0))};function z(t,F){navigator.clipboard.writeText(F).then(()=>{g(t),setTimeout(()=>g(null),2e3)})}const G=s.filter(t=>!t.locked).length,M=s.filter(t=>t.locked).length;return e.jsxs(Q,{children:[e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Client Keys Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Generate and manage API keys for client authentication"})]}),e.jsxs(j,{onClick:H,disabled:I,size:"lg",className:"w-full sm:w-auto",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Generate New Key"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Keys"}),e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All generated keys"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Available Keys"}),e.jsx(T,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:G}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Ready for use"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Locked Keys"}),e.jsx(f,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:M}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Temporarily locked / in use"})]})]})]}),s.length===0&&e.jsxs(q,{children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx(J,{children:'No client keys have been generated yet. Click the "Generate New Key" button to create your first key.'})]}),s.length>0&&e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"API Keys"}),e.jsx(V,{children:"View and manage all generated client authentication keys"})]}),e.jsx(p,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(S,{children:[e.jsx(n,{className:"w-[80px]",children:"ID"}),e.jsx(n,{children:"Key"}),e.jsx(n,{className:"w-[120px]",children:"Status"}),e.jsx(n,{className:"w-[180px]",children:"Created At"}),e.jsx(n,{className:"w-[100px] text-right",children:"Actions"})]})}),e.jsx(re,{children:s.map(t=>e.jsxs(S,{className:"group",children:[e.jsxs(o,{className:"font-medium text-muted-foreground",children:["#",t.id]}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"relative rounded bg-muted px-[0.5rem] py-[0.3rem] font-mono text-sm flex-1 overflow-hidden text-ellipsis",children:t.key}),e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>z(t.id,t.key),title:"Copy to clipboard",children:O===t.id?e.jsx(T,{className:"h-4 w-4 text-green-500"}):e.jsx(Z,{className:"h-4 w-4"})})]})}),e.jsx(o,{children:t.locked?e.jsx(y,{variant:"destructive",className:"font-normal",children:"Locked"}):e.jsx(y,{variant:"default",className:"bg-green-500 hover:bg-green-600 font-normal",children:"Available"})}),e.jsx(o,{className:"text-muted-foreground",children:new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx(o,{className:"text-right",children:e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>R(t),className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10",title:"Delete key",children:e.jsx(ee,{className:"h-4 w-4"})})})]},t.id))})]})})})]})]}),e.jsx(w,{open:P,onOpenChange:d,children:e.jsxs(v,{children:[e.jsxs(C,{children:[e.jsx(A,{children:"Are you sure?"}),e.jsx(D,{children:"This action cannot be undone. The selected client key will be permanently deleted."})]}),e.jsxs(k,{children:[e.jsx(W,{children:"Cancel"}),e.jsx(K,{onClick:L,className:"bg-destructive text-white hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(w,{open:B,onOpenChange:i,children:e.jsxs(v,{children:[e.jsxs(C,{children:[e.jsxs(A,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(f,{className:"h-5 w-5"}),N.title]}),e.jsx(D,{children:N.description})]}),e.jsx(k,{children:e.jsx(K,{onClick:()=>i(!1),children:"OK"})})]})})]})}export{De as default};
