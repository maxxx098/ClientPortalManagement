import{j as e,r as n,R as ee,b as E}from"./app-Bnkg_R6e.js";import{a as F,B as d}from"./createLucideIcon-DNcdlP6E.js";import{C as se,S as te,a as re,c as ae,d as M}from"./select-BCOHzWoz.js";import{C as N,c as T}from"./card-DwGzBwsB.js";import{T as le}from"./trending-up-BPB2ATXg.js";import{C as ne}from"./clock-c-VfPZLC.js";import{P as B}from"./plus-hvYSpbLW.js";import{C as oe}from"./calendar-DRvwWHG-.js";import{E as ie}from"./eye-B1PD48oW.js";import{T as ce}from"./TaskSidebar-DVpbSR5T.js";import{A as R,e as U,f as V,g as H,F as K}from"./app-sidebar-header-CEjx-qTJ.js";/* empty css            */import"./index-C0YS4r49.js";import"./index-C93J2Ucv.js";import"./index-kHAuEXaX.js";import"./index-CMWG4mbA.js";import"./index-xCdiWUdy.js";import"./check-CyH3QDRj.js";import"./input-CU7_24SH.js";import"./textarea-za3Y1BeD.js";import"./label-C6LTBqDR.js";import"./circle-ov8ltoZn.js";import"./dialog-C9Ih4Tji.js";import"./file-text-DWZKf2U7.js";import"./trash-2-4lLBmTRr.js";import"./index-D329iiHL.js";import"./Logo-Cmirgiq5.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],me=F("CheckCheck",de);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]],he=F("CircuitBoard",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]],pe=F("Flag",ue),fe={todo:{label:"To Do",color:"text-gray-400"},in_progress:{label:"In Progress",color:"text-blue-500"},done:{label:"Done",color:"text-emerald-500"}};function je({tasks:a,searchQuery:b,expandedSections:w,routePrefix:u,onToggleSection:I,onAddTask:k,onView:p,onEdit:i,onDelete:_,onUpdateStatus:f}){const j=s=>s.progress_status||"on_track",o=a.filter(s=>s.title.toLowerCase().includes(b.toLowerCase())||s.description?.toLowerCase().includes(b.toLowerCase())),y={on_track:{title:"On Track",tasks:o.filter(s=>j(s)==="on_track")},at_risk:{title:"At Risk",tasks:o.filter(s=>j(s)==="at_risk")},off_track:{title:"Off Track",tasks:o.filter(s=>j(s)==="off_track")}},c=a.filter(s=>s.status==="done").length,D=a.filter(s=>s.status==="in_progress").length,m=a.filter(s=>s.status==="todo").length;return e.jsx("div",{className:"min-h-screen bg-background text-foreground",children:e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8",children:[e.jsx("div",{className:"flex items-center justify-between flex-wrap gap-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight",children:"Task Overview"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Overview of all tasks and progress."})]})}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(N,{children:e.jsxs(T,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"Total Tasks"}),e.jsx(he,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold",children:a.length})]})}),e.jsx(N,{children:e.jsxs(T,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"In Progress"}),e.jsx(le,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold text-blue-500",children:D})]})}),e.jsx(N,{children:e.jsxs(T,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"Completed"}),e.jsx(me,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold text-emerald-500",children:c})]})}),e.jsx(N,{children:e.jsxs(T,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"To Do"}),e.jsx(ne,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold text-gray-400",children:m})]})})]}),Object.entries(y).map(([s,x])=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>I(s),className:"hover:bg-muted p-1 rounded transition",children:e.jsx(se,{className:`h-4 w-4 text-muted-foreground transition-transform ${w[s]?"":"-rotate-90"}`})}),e.jsx("h2",{className:"text-sm font-medium",children:x.title}),e.jsx("span",{className:"text-xs text-muted-foreground",children:x.tasks.length}),e.jsx("div",{className:"ml-auto flex items-center gap-1",children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>k(s),className:"h-7 w-7",children:e.jsx(B,{className:"h-4 w-4"})})})]}),w[s]&&e.jsx("div",{className:"rounded-lg border border-border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-2 text-xs text-muted-foreground border-b border-border",children:[e.jsx("div",{className:"col-span-4",children:"Task"}),e.jsx("div",{className:"col-span-2",children:"Assignee"}),e.jsx("div",{className:"col-span-2",children:"Due"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2 text-right",children:"Actions"})]}),e.jsxs("div",{className:"divide-y divide-border",children:[x.tasks.map(r=>{const P=fe[r.status],S=r.priority||"low",L={high:"bg-red-500/10 text-red-500 border border-red-500/30",medium:"bg-yellow-500/10 text-yellow-500 border border-yellow-500/30",low:"bg-green-500/10 text-green-500 border border-green-500/30"};return e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 text-sm hover:bg-muted/30 transition",children:[e.jsxs("div",{className:"col-span-4 flex items-center gap-2",children:[e.jsx("span",{className:"font-medium truncate",children:r.title}),e.jsxs("span",{className:`text-[10px] flex justify-center items-center gap-1 px-2 py-0.5 rounded-full capitalize whitespace-nowrap flex-shrink-0 ${L[S]}`,children:[e.jsx(pe,{size:10}),S]})]}),e.jsx("div",{className:"col-span-2 flex items-center",children:e.jsx("div",{className:"w-7 h-7 rounded-full bg-muted flex items-center justify-center text-xs font-medium",children:r.client_key_id?.substring(0,2).toUpperCase()||"NA"})}),e.jsxs("div",{className:"col-span-2 flex items-center text-muted-foreground",children:[e.jsx(oe,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:r.due_date?new Date(r.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"â€”"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs(te,{value:r.status,onValueChange:h=>f(r.id,h),children:[e.jsx(re,{className:"h-8 px-3 text-xs font-medium border border-border w-full",children:e.jsx("span",{className:P.color,children:P.label})}),e.jsxs(ae,{children:[e.jsx(M,{value:"todo",children:"To Do"}),e.jsx(M,{value:"in_progress",children:"In Progress"}),e.jsx(M,{value:"done",children:"Done"})]})]})}),e.jsxs("div",{className:"col-span-2 flex items-center justify-end gap-2",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>p(r.id),className:"h-8 w-8 flex-shrink-0",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>i(r),className:"h-8 w-8 flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>_(r.id),className:"h-8 w-8 flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4 text-destructive",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},r.id)}),e.jsxs("div",{onClick:()=>k(s),className:"px-4 py-3 text-xs text-muted-foreground hover:bg-muted/30 cursor-pointer flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Add Task"]})]})]})})})]},s))]})})}function qe({tasks:a,clients:b=[],client_key_id:w,auth:u,hasClientKeys:I=!0,hasProjects:k=!0}){const[p,i]=n.useState(!1),[_,f]=n.useState("view"),[j,o]=n.useState(null),[y,c]=n.useState(a),[D,m]=n.useState(!1),[s,x]=n.useState(null),[r,P]=n.useState(""),[S,L]=n.useState({on_track:!0,at_risk:!0,off_track:!0}),[h,g]=n.useState(!1),[ge,A]=n.useState(null),C=u.user.role==="admin"?"/admin":"/client";if(ee.useEffect(()=>{c(a)},[a]),!k)return e.jsxs(R,{variant:"sidebar",children:[e.jsx(U,{}),e.jsxs(V,{children:[e.jsx(H,{breadcrumbs:[]}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-[70vh] text-center p-6",children:[e.jsx("div",{className:"rounded-full bg-blue-500/10 p-6 mb-6",children:e.jsx(K,{className:"w-16 h-16 text-blue-500"})}),e.jsx("h1",{className:"text-2xl font-bold mb-3",children:"No Projects Found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md",children:"You need to create at least one project before creating or managing tasks."}),e.jsxs(d,{onClick:()=>E.visit("/admin/projects"),className:"gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Go to Project Management"]})]})]})]});const q=t=>{L(l=>({...l,[t]:!l[t]}))},W=t=>{const l=y.find(v=>v.id===t);l&&(o(l),f("view"),i(!0))},G=t=>{o(t),f("edit"),i(!0)},Q=t=>{A(t),o(null),f("create"),i(!0)},$=t=>{x(t),m(!0)},Y=()=>{s!==null&&(g(!0),c(t=>t.filter(l=>l.id!==s)),E.delete(`${C}/tasks/${s}`,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{m(!1),x(null),g(!1),i(!1)},onError:t=>{console.error("Failed to delete task:",t),c(a),g(!1)}}))},J=t=>{g(!0),setTimeout(()=>{g(!1),i(!1),o(null),A(null)},500)},X=(t,l)=>{c(z=>z.map(O=>O.id===t?{...O,status:l}:O));const v=new FormData;v.append("status",l),v.append("_method","PATCH"),E.post(`${C}/tasks/${t}`,v,{preserveScroll:!0,onSuccess:()=>{console.log("Status updated successfully")},onError:z=>{console.error("Failed to update status:",z),c(a)}})},Z=()=>{i(!1),o(null),A(null)};return e.jsxs(R,{variant:"sidebar",children:[e.jsx(U,{}),e.jsxs(V,{className:"overflow-x-hidden transition-[margin-right] duration-300 ease-linear",style:{marginRight:p?"24rem":"0"},children:[e.jsx(H,{breadcrumbs:[]}),e.jsx(je,{tasks:y,searchQuery:r,expandedSections:S,routePrefix:C,onToggleSection:q,onAddTask:Q,onView:W,onEdit:G,onDelete:$,onUpdateStatus:X}),e.jsx("div",{className:`fixed right-0 top-0 h-full w-96 transform transition-transform duration-300 ease-linear z-[100] ${p?"translate-x-0":"translate-x-full"}`,children:e.jsx(ce,{isOpen:p,task:j,mode:_,isLoading:h,onClose:Z,onSave:J,onDelete:$,clients:b,userRole:u.user.role,isAdmin:u.user.role==="admin",clientKey:w,currentUserId:u.user.id,routePrefix:C})}),D&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>m(!1)}),e.jsxs(N,{className:" border rounded-lg p-6 max-w-sm relative z-10 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Delete Task?"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"This action cannot be undone. The task will be permanently deleted."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(d,{variant:"outline",onClick:()=>m(!1),disabled:h,children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:Y,disabled:h,children:h?"Deleting...":"Delete"})]})]})]})]})]})}export{qe as default};
