import{j as e,r as l,R as le,b as M}from"./app-Ck5WeuDF.js";import{a as q,B as R}from"./createLucideIcon-B_bktm_V.js";import{S as ie,a as ne,c as oe,d as K}from"./select-Dx1FEl9V.js";import{R as k}from"./generateCategoricalChart-DH_vL4Kd.js";import{L as D,a as S}from"./LineChart-TIK0wLy6.js";import{A as C}from"./arrow-up-right-w28fp5fE.js";import{C as ce}from"./index-DbRe66M7.js";import{P as H}from"./plus-C_1lLlVA.js";import{C as de}from"./calendar-DFfyr8YL.js";import{E as xe}from"./eye-Cp_TVztM.js";import{T as me}from"./TaskSidebar-BUc7aAwL.js";import{A as V,e as W,f as G,F as Q}from"./app-sidebar-DDhbTrZc.js";import{A as Y}from"./app-sidebar-header-DZLkAQAh.js";import{C as he}from"./card-DEJaNszi.js";import{A as ue,a as pe,b as fe,c as je,d as ge,e as be,g as ve}from"./alert-dialog-CFoMYek6.js";import{T as we}from"./triangle-alert-6KhT8hyG.js";/* empty css            */import"./index-_ENhd-2p.js";import"./index-CN8Djskw.js";import"./index-DVV6Sig4.js";import"./check-CaqIbujm.js";import"./index-CMWG4mbA.js";import"./input-CUw1qsVt.js";import"./textarea-BWAqC_mb.js";import"./label-Db5HK2jy.js";import"./circle-DZVjkmYv.js";import"./dialog-OqLuxiCo.js";import"./message-square-1WfBuX9x.js";import"./file-text-DGqMEeyL.js";import"./trash-2-Ccc7LcjO.js";import"./index-D329iiHL.js";import"./Logo-Cmirgiq5.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]],ye=q("CircuitBoard",Ne);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]],De=q("Flag",ke),Se={todo:{label:"To Do",color:"text-gray-400"},in_progress:{label:"In Progress",color:"text-blue-400"},done:{label:"Done",color:"text-emerald-400"}};function Ce({tasks:a,searchQuery:b,expandedSections:v,routePrefix:u,onToggleSection:p,onAddTask:T,onView:A,onEdit:f,onDelete:n,onUpdateStatus:_}){const o=s=>s.progress_status||"on_track",j=a.filter(s=>s.title.toLowerCase().includes(b.toLowerCase())||s.description?.toLowerCase().includes(b.toLowerCase())),x={on_track:{title:"On Track",tasks:j.filter(s=>o(s)==="on_track")},at_risk:{title:"At Risk",tasks:j.filter(s=>o(s)==="at_risk")},off_track:{title:"Off Track",tasks:j.filter(s=>o(s)==="off_track")}},w=a.filter(s=>s.status==="done").length,c=a.filter(s=>s.status==="in_progress").length,L=a.filter(s=>s.status==="todo").length,m=new Date().toLocaleDateString("en-US",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return e.jsx("div",{className:"min-h-screen text-gray-200",children:e.jsxs("div",{className:"p-8 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-white/5 pb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-light italic text-white",children:"Task Overview"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:m})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/5 p-5 rounded-2xl flex flex-col justify-between h-40 hover:border-yellow-500/20 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 tracking-wider mb-2 uppercase",children:"Total Tasks"}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:a.length})]}),e.jsx("div",{className:"w-24 h-12",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsx(D,{data:[{value:1},{value:10},{value:1},{value:1},{value:1},{value:1},{value:7}],children:e.jsx(S,{type:"natural",dataKey:"value",stroke:"#8b5cf6",strokeWidth:2,dot:!1})})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-purple-400",children:[e.jsx("span",{className:"mr-1",children:"12%"}),e.jsx(C,{size:14})]}),e.jsx("div",{className:"flex items-center text-[10px] text-gray-500 uppercase",children:e.jsx("span",{children:"This month"})})]})]}),e.jsxs("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/5 p-5 rounded-2xl flex flex-col justify-between h-40 hover:border-yellow-500/20 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 tracking-wider mb-2 uppercase",children:"In Progress"}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:c})]}),e.jsx("div",{className:"w-24 h-12",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsx(D,{data:[{value:7},{value:6},{value:1},{value:4},{value:1},{value:8},{value:7}],children:e.jsx(S,{type:"natural",dataKey:"value",stroke:"#3b82f6",strokeWidth:2,dot:!1})})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-blue-400",children:[e.jsx("span",{className:"mr-1",children:"8%"}),e.jsx(C,{size:14})]}),e.jsx("div",{className:"flex items-center text-[10px] text-gray-500 uppercase",children:e.jsx("span",{children:"Active now"})})]})]}),e.jsxs("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/5 p-5 rounded-2xl flex flex-col justify-between h-40 hover:border-yellow-500/20 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 tracking-wider mb-2 uppercase",children:"Completed"}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:w})]}),e.jsx("div",{className:"w-24 h-12",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsx(D,{data:[{value:4},{value:7},{value:3},{value:10},{value:3},{value:1},{value:1}],children:e.jsx(S,{type:"natural",dataKey:"value",stroke:"#22c55e",strokeWidth:2,dot:!1})})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-green-400",children:[e.jsx("span",{className:"mr-1",children:"15%"}),e.jsx(C,{size:14})]}),e.jsx("div",{className:"flex items-center text-[10px] text-gray-500 uppercase",children:e.jsx("span",{children:"This week"})})]})]}),e.jsxs("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/5 p-5 rounded-2xl flex flex-col justify-between h-40 hover:border-yellow-500/20 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 tracking-wider mb-2 uppercase",children:"To Do"}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:L})]}),e.jsx("div",{className:"w-24 h-12",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsx(D,{data:[{value:5},{value:4},{value:6},{value:3},{value:5},{value:4},{value:5}],children:e.jsx(S,{type:"natural",dataKey:"value",stroke:"#6b7280",strokeWidth:2,dot:!1})})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-gray-400",children:[e.jsx("span",{className:"mr-1",children:"5%"}),e.jsx(C,{size:14})]}),e.jsx("div",{className:"flex items-center text-[10px] text-gray-500 uppercase",children:e.jsx("span",{children:"Pending"})})]})]})]}),Object.entries(x).map(([s,d])=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>p(s),className:"hover:bg-white/5 p-2 rounded-lg transition",children:e.jsx(ce,{className:`h-5 w-5 text-gray-400 transition-transform ${v[s]?"":"-rotate-90"}`})}),e.jsx("h2",{className:"text-lg font-bold text-white",children:d.title}),e.jsx("span",{className:"text-sm text-gray-500 bg-white/5 px-2 py-1 rounded-full",children:d.tasks.length}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{onClick:()=>T(s),className:"p-2 bg-yellow-500 text-black rounded-full hover:bg-yellow-400 transition-colors shadow-lg shadow-yellow-500/20",children:e.jsx(H,{className:"h-5 w-5"})})})]}),v[s]&&e.jsx("div",{className:"rounded-2xl border border-white/5 bg-white/[0.02] backdrop-blur-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-6 py-4 text-xs text-gray-400 border-b border-white/5 bg-white/[0.03] uppercase tracking-wider font-semibold",children:[e.jsx("div",{className:"col-span-4",children:"Task"}),e.jsx("div",{className:"col-span-2",children:"Assignee"}),e.jsx("div",{className:"col-span-2",children:"Due"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2 text-right",children:"Actions"})]}),e.jsxs("div",{className:"divide-y divide-white/5",children:[d.tasks.length===0?e.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(ye,{className:"w-12 h-12 opacity-20 mx-auto mb-3"}),e.jsx("p",{className:"text-sm",children:"No tasks in this section"})]}):d.tasks.map(r=>{const P=Se[r.status],N=r.priority||"low",z={high:"bg-red-500/20 text-red-400 border border-red-500/30",medium:"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30",low:"bg-green-500/20 text-green-400 border border-green-500/30"};return e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-6 py-4 text-sm hover:bg-white/[0.02] transition group",children:[e.jsxs("div",{className:"col-span-4 flex items-center gap-3",children:[e.jsx("span",{className:"font-medium text-white line-clamp-1",children:r.title}),e.jsxs("span",{className:`text-[10px] flex items-center gap-1 px-2 py-1 rounded-full capitalize whitespace-nowrap flex-shrink-0 font-medium ${z[N]}`,children:[e.jsx(De,{size:10}),N]})]}),e.jsx("div",{className:"col-span-2 flex items-center",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-xs font-semibold text-white shadow-lg",children:r.client_key_id?.substring(0,2).toUpperCase()||"NA"})}),e.jsxs("div",{className:"col-span-2 flex items-center text-gray-400",children:[e.jsx(de,{className:"h-4 w-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap text-sm",children:r.due_date?new Date(r.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"No date"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs(ie,{value:r.status,onValueChange:h=>_(r.id,h),children:[e.jsx(ne,{className:"h-9 px-3 text-xs font-medium border border-white/10 w-full bg-white/5 rounded-xl hover:bg-white/10 transition-colors",children:e.jsx("span",{className:P.color,children:P.label})}),e.jsxs(oe,{className:"bg-[#0a0a0a] border-white/10",children:[e.jsx(K,{value:"todo",className:"text-white",children:"To Do"}),e.jsx(K,{value:"in_progress",className:"text-white",children:"In Progress"}),e.jsx(K,{value:"done",className:"text-white",children:"Done"})]})]})}),e.jsxs("div",{className:"col-span-2 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>A(r.id),className:"h-9 w-9 rounded-xl hover:bg-white/10 flex items-center justify-center transition-colors",children:e.jsx(xe,{className:"h-4 w-4 text-gray-400 group-hover:text-white transition-colors"})}),e.jsx("button",{onClick:()=>f(r),className:"h-9 w-9 rounded-xl hover:bg-white/10 flex items-center justify-center transition-colors",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400 group-hover:text-white transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>n(r.id),className:"h-9 w-9 rounded-xl hover:bg-red-500/10 flex items-center justify-center transition-colors",children:e.jsx("svg",{className:"h-4 w-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},r.id)}),e.jsxs("div",{onClick:()=>T(s),className:"px-6 py-4 text-sm text-gray-400 hover:bg-white/[0.02] cursor-pointer flex items-center gap-2 transition font-medium",children:[e.jsx(H,{className:"h-5 w-5"}),"Add New Task"]})]})]})})})]},s))]})})}function ns({tasks:a,clients:b=[],client_key_id:v,auth:u,project:p,hasClientKeys:T=!0,hasProjects:A=!0}){const[f,n]=l.useState(!1),[_,o]=l.useState("view"),[j,x]=l.useState(null),[w,c]=l.useState(a),[L,m]=l.useState(!1),[s,d]=l.useState(null),[r,P]=l.useState(""),[N,z]=l.useState({on_track:!0,at_risk:!0,off_track:!0}),[h,O]=l.useState(!1),[Te,U]=l.useState(null),y=u.user.role==="admin"?"/admin":"/client",[$,E]=l.useState(!1);if(le.useEffect(()=>{c(a)},[a]),!A)return e.jsxs(V,{variant:"sidebar",children:[e.jsx(W,{}),e.jsxs(G,{children:[e.jsx(Y,{breadcrumbs:[]}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-[70vh] text-center p-6",children:[e.jsx("div",{className:"rounded-full bg-blue-500/10 p-6 mb-6",children:e.jsx(Q,{className:"w-16 h-16 text-blue-500"})}),e.jsx("h1",{className:"text-2xl font-bold mb-3",children:"No Projects Found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md",children:"You need to create at least one project before creating or managing tasks."}),e.jsxs(R,{onClick:()=>M.visit("/admin/projects"),className:"gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Go to Project Management"]})]})]})]});const J=t=>{z(i=>({...i,[t]:!i[t]}))},X=t=>{const i=w.find(g=>g.id===t);i&&(x(i),o("view"),n(!0))},Z=t=>{x(t),o("edit"),n(!0)},ee=t=>{U(t),x(null),o("create"),n(!0)},B=t=>{d(t),m(!0)},se=()=>{s!==null&&(O(!0),c(t=>t.filter(i=>i.id!==s)),M.delete(`${y}/tasks/${s}`,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{m(!1),d(null),O(!1),n(!1)},onError:t=>{console.error("Failed to delete task:",t),c(a),O(!1)}}))},te=(t,i)=>{c(F=>F.map(I=>I.id===t?{...I,status:i}:I));const g=new FormData;g.append("status",i),g.append("_method","PATCH"),M.post(`${y}/tasks/${t}`,g,{preserveScroll:!0,onSuccess:()=>{console.log("Status updated successfully")},onError:F=>{console.error("Failed to update status:",F),c(a)}})},re=()=>{n(!1),x(null),U(null)},ae=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set";return e.jsxs(V,{variant:"sidebar",children:[e.jsx(W,{}),e.jsxs(G,{className:"overflow-x-hidden transition-[margin-right] duration-300 ease-linear",style:{marginRight:f?"24rem":"0"},children:[e.jsx(Y,{breadcrumbs:[]}),e.jsx(Ce,{tasks:w,searchQuery:r,expandedSections:N,routePrefix:y,onToggleSection:J,onAddTask:ee,onView:X,onEdit:Z,onDelete:B,onUpdateStatus:te}),e.jsx("div",{className:`fixed right-0 top-0 h-full w-96 transform transition-transform duration-300 ease-linear z-[100] ${f?"translate-x-0":"translate-x-full"}`,children:e.jsx(me,{isOpen:f,task:j,mode:_,isLoading:h,onClose:re,onDelete:B,clients:b,userRole:u.user.role,isAdmin:u.user.role==="admin",clientKey:v,currentUserId:u.user.id,routePrefix:y,projectDueDate:p?.due_date,onDueDateError:()=>E(!0)})}),L&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>m(!1)}),e.jsxs(he,{className:" border rounded-lg p-6 max-w-sm relative z-10 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Delete Task?"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"This action cannot be undone. The task will be permanently deleted."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(R,{variant:"outline",onClick:()=>m(!1),disabled:h,children:"Cancel"}),e.jsx(R,{variant:"destructive",onClick:se,disabled:h,children:h?"Deleting...":"Delete"})]})]})]})]}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[199]"}),e.jsx(ue,{open:$,onOpenChange:E,children:e.jsxs(pe,{className:"z-[200]",children:[e.jsxs(fe,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-500/10 flex items-center justify-center",children:e.jsx(we,{className:"h-5 w-5 text-amber-500"})}),e.jsx(je,{className:"text-lg font-semibold",children:"Invalid Due Date"})]}),e.jsxs(ge,{className:"text-sm text-muted-foreground",children:["The task due date cannot be later than the project due date (",p?.due_date?ae(p.due_date):"N/A","). Please select a valid due date."]})]}),e.jsx(be,{children:e.jsx(ve,{onClick:()=>E(!1),children:"OK"})})]})})]})}export{ns as default};
