import{j as e,r as l,R as re,b as I}from"./app-2bThjdGw.js";import{a as $,B as m}from"./createLucideIcon-Cj-60cLs.js";import{C as ae,S as le,a as ne,c as ie,d as M}from"./select-BI5UQCWF.js";import{C as g,c as C}from"./card-CX17PSv1.js";import{T as oe}from"./trending-up-B_xNrws_.js";import{C as ce}from"./clock-Dn2dRDL2.js";import{P as R}from"./plus--bGEC2ap.js";import{C as de}from"./calendar-Da2OhsI6.js";import{E as me}from"./eye-Cbq31AxV.js";import{T as xe}from"./TaskSidebar-A19pG-ju.js";import{A as V,e as K,f as q,F as W}from"./app-sidebar-BTUOFd8O.js";import{A as G}from"./app-sidebar-header-ZhWttKuU.js";import{A as ue,a as he,b as pe,c as fe,d as je,e as ge,g as Ne}from"./alert-dialog-BbNZ9SL5.js";import{T as ve}from"./triangle-alert-BuNV5dUC.js";/* empty css            */import"./index-nJaiqGQS.js";import"./index-BuMaAU40.js";import"./index-BFxOKshg.js";import"./index-CMWG4mbA.js";import"./index-5F4qYVKl.js";import"./check-BNB34e7s.js";import"./input-CRHbo_CQ.js";import"./textarea-C2t_u44s.js";import"./label-Bb1y9hyw.js";import"./circle-BuDsbuES.js";import"./dialog-Ci460en-.js";import"./file-text-_BLigFwR.js";import"./trash-2-tlgGR3Qh.js";import"./index-D329iiHL.js";import"./Logo-Cmirgiq5.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],we=$("CheckCheck",be);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]],ye=$("CircuitBoard",ke);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]],Se=$("Flag",Ce),De={todo:{label:"To Do",color:"text-gray-400"},in_progress:{label:"In Progress",color:"text-blue-500"},done:{label:"Done",color:"text-emerald-500"}};function Te({tasks:a,searchQuery:N,expandedSections:v,routePrefix:u,onToggleSection:h,onAddTask:S,onView:D,onEdit:p,onDelete:i,onUpdateStatus:T}){const o=s=>s.progress_status||"on_track",f=a.filter(s=>s.title.toLowerCase().includes(N.toLowerCase())||s.description?.toLowerCase().includes(N.toLowerCase())),x={on_track:{title:"On Track",tasks:f.filter(s=>o(s)==="on_track")},at_risk:{title:"At Risk",tasks:f.filter(s=>o(s)==="at_risk")},off_track:{title:"Off Track",tasks:f.filter(s=>o(s)==="off_track")}},b=a.filter(s=>s.status==="done").length,c=a.filter(s=>s.status==="in_progress").length,_=a.filter(s=>s.status==="todo").length;return e.jsx("div",{className:"min-h-screen bg-background text-foreground",children:e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8",children:[e.jsx("div",{className:"flex items-center justify-between flex-wrap gap-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight",children:"Task Overview"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Overview of all tasks and progress."})]})}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(g,{children:e.jsxs(C,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"Total Tasks"}),e.jsx(ye,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold",children:a.length})]})}),e.jsx(g,{children:e.jsxs(C,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"In Progress"}),e.jsx(oe,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold text-blue-500",children:c})]})}),e.jsx(g,{children:e.jsxs(C,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"Completed"}),e.jsx(we,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold text-emerald-500",children:b})]})}),e.jsx(g,{children:e.jsxs(C,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground",children:"To Do"}),e.jsx(ce,{className:"h-3 w-3 sm:h-4 sm:w-4 text-muted-foreground"})]}),e.jsx("div",{className:"mt-2 text-xl sm:text-2xl font-semibold text-gray-400",children:_})]})})]}),Object.entries(x).map(([s,d])=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h(s),className:"hover:bg-muted p-1 rounded transition",children:e.jsx(ae,{className:`h-4 w-4 text-muted-foreground transition-transform ${v[s]?"":"-rotate-90"}`})}),e.jsx("h2",{className:"text-sm font-medium",children:d.title}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d.tasks.length}),e.jsx("div",{className:"ml-auto flex items-center gap-1",children:e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>S(s),className:"h-7 w-7",children:e.jsx(R,{className:"h-4 w-4"})})})]}),v[s]&&e.jsx("div",{className:"rounded-lg border border-border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-2 text-xs text-muted-foreground border-b border-border",children:[e.jsx("div",{className:"col-span-4",children:"Task"}),e.jsx("div",{className:"col-span-2",children:"Assignee"}),e.jsx("div",{className:"col-span-2",children:"Due"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2 text-right",children:"Actions"})]}),e.jsxs("div",{className:"divide-y divide-border",children:[d.tasks.map(r=>{const w=De[r.status],A=r.priority||"low",P={high:"bg-red-500/10 text-red-500 border border-red-500/30",medium:"bg-yellow-500/10 text-yellow-500 border border-yellow-500/30",low:"bg-green-500/10 text-green-500 border border-green-500/30"};return e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 text-sm hover:bg-muted/30 transition",children:[e.jsxs("div",{className:"col-span-4 flex items-center gap-2",children:[e.jsx("span",{className:"font-medium truncate",children:r.title}),e.jsxs("span",{className:`text-[10px] flex justify-center items-center gap-1 px-2 py-0.5 rounded-full capitalize whitespace-nowrap flex-shrink-0 ${P[A]}`,children:[e.jsx(Se,{size:10}),A]})]}),e.jsx("div",{className:"col-span-2 flex items-center",children:e.jsx("div",{className:"w-7 h-7 rounded-full bg-muted flex items-center justify-center text-xs font-medium",children:r.client_key_id?.substring(0,2).toUpperCase()||"NA"})}),e.jsxs("div",{className:"col-span-2 flex items-center text-muted-foreground",children:[e.jsx(de,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:r.due_date?new Date(r.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"â€”"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs(le,{value:r.status,onValueChange:L=>T(r.id,L),children:[e.jsx(ne,{className:"h-8 px-3 text-xs font-medium border border-border w-full",children:e.jsx("span",{className:w.color,children:w.label})}),e.jsxs(ie,{children:[e.jsx(M,{value:"todo",children:"To Do"}),e.jsx(M,{value:"in_progress",children:"In Progress"}),e.jsx(M,{value:"done",children:"Done"})]})]})}),e.jsxs("div",{className:"col-span-2 flex items-center justify-end gap-2",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>D(r.id),className:"h-8 w-8 flex-shrink-0",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>p(r),className:"h-8 w-8 flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>i(r.id),className:"h-8 w-8 flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4 text-destructive",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},r.id)}),e.jsxs("div",{onClick:()=>S(s),className:"px-4 py-3 text-xs text-muted-foreground hover:bg-muted/30 cursor-pointer flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Add Task"]})]})]})})})]},s))]})})}function ns({tasks:a,clients:N=[],client_key_id:v,auth:u,project:h,hasClientKeys:S=!0,hasProjects:D=!0}){const[p,i]=l.useState(!1),[T,o]=l.useState("view"),[f,x]=l.useState(null),[b,c]=l.useState(a),[_,s]=l.useState(!1),[d,r]=l.useState(null),[w,A]=l.useState(""),[P,L]=l.useState({on_track:!0,at_risk:!0,off_track:!0}),[k,z]=l.useState(!1),[_e,B]=l.useState(null),y=u.user.role==="admin"?"/admin":"/client",[U,O]=l.useState(!1);if(re.useEffect(()=>{c(a)},[a]),!D)return e.jsxs(V,{variant:"sidebar",children:[e.jsx(K,{}),e.jsxs(q,{children:[e.jsx(G,{breadcrumbs:[]}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-[70vh] text-center p-6",children:[e.jsx("div",{className:"rounded-full bg-blue-500/10 p-6 mb-6",children:e.jsx(W,{className:"w-16 h-16 text-blue-500"})}),e.jsx("h1",{className:"text-2xl font-bold mb-3",children:"No Projects Found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md",children:"You need to create at least one project before creating or managing tasks."}),e.jsxs(m,{onClick:()=>I.visit("/admin/projects"),className:"gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Go to Project Management"]})]})]})]});const Q=t=>{L(n=>({...n,[t]:!n[t]}))},Y=t=>{const n=b.find(j=>j.id===t);n&&(x(n),o("view"),i(!0))},J=t=>{x(t),o("edit"),i(!0)},X=t=>{B(t),x(null),o("create"),i(!0)},H=t=>{r(t),s(!0)},Z=()=>{d!==null&&(z(!0),c(t=>t.filter(n=>n.id!==d)),I.delete(`${y}/tasks/${d}`,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{s(!1),r(null),z(!1),i(!1)},onError:t=>{console.error("Failed to delete task:",t),c(a),z(!1)}}))},ee=(t,n)=>{c(E=>E.map(F=>F.id===t?{...F,status:n}:F));const j=new FormData;j.append("status",n),j.append("_method","PATCH"),I.post(`${y}/tasks/${t}`,j,{preserveScroll:!0,onSuccess:()=>{console.log("Status updated successfully")},onError:E=>{console.error("Failed to update status:",E),c(a)}})},se=()=>{i(!1),x(null),B(null)},te=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set";return e.jsxs(V,{variant:"sidebar",children:[e.jsx(K,{}),e.jsxs(q,{className:"overflow-x-hidden transition-[margin-right] duration-300 ease-linear",style:{marginRight:p?"24rem":"0"},children:[e.jsx(G,{breadcrumbs:[]}),e.jsx(Te,{tasks:b,searchQuery:w,expandedSections:P,routePrefix:y,onToggleSection:Q,onAddTask:X,onView:Y,onEdit:J,onDelete:H,onUpdateStatus:ee}),e.jsx("div",{className:`fixed right-0 top-0 h-full w-96 transform transition-transform duration-300 ease-linear z-[100] ${p?"translate-x-0":"translate-x-full"}`,children:e.jsx(xe,{isOpen:p,task:f,mode:T,isLoading:k,onClose:se,onDelete:H,clients:N,userRole:u.user.role,isAdmin:u.user.role==="admin",clientKey:v,currentUserId:u.user.id,routePrefix:y,projectDueDate:h?.due_date,onDueDateError:()=>O(!0)})}),_&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>s(!1)}),e.jsxs(g,{className:" border rounded-lg p-6 max-w-sm relative z-10 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Delete Task?"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"This action cannot be undone. The task will be permanently deleted."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(m,{variant:"outline",onClick:()=>s(!1),disabled:k,children:"Cancel"}),e.jsx(m,{variant:"destructive",onClick:Z,disabled:k,children:k?"Deleting...":"Delete"})]})]})]})]}),U&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[199]"}),e.jsx(ue,{open:U,onOpenChange:O,children:e.jsxs(he,{className:"z-[200]",children:[e.jsxs(pe,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-500/10 flex items-center justify-center",children:e.jsx(ve,{className:"h-5 w-5 text-amber-500"})}),e.jsx(fe,{className:"text-lg font-semibold",children:"Invalid Due Date"})]}),e.jsxs(je,{className:"text-sm text-muted-foreground",children:["The task due date cannot be later than the project due date (",h?.due_date?te(h.due_date):"N/A","). Please select a valid due date."]})]}),e.jsx(ge,{children:e.jsx(Ne,{onClick:()=>O(!1),children:"OK"})})]})})]})}export{ns as default};
